{% load static %}

<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <!-- 引入 ECharts 文件 使用 static 关键字-->
    <style type="text/css">
     .chart {
       height:480px;
     }
    </style>
    <script type="text/javascript" src="http://echarts.baidu.com/gallery/vendors/echarts/echarts.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
  </head>
</html>
<body>
  <!-- 为 ECharts 准备一个具备大小（宽高）的 DOM -->
  <div class="container">
    {% for group in groups %}
    <div class="row">
      {% for chart in group.charts %}

      <div id="{{chart.chart_name}}-{{forloop.counter}}" class="chart col-md-6">
        xxxxx<br><br>
      </div>
      <script type="text/javascript">
        // 基于准备好的 dom，初始化 echarts 实例
        var backend_data = {{ groups|safe }};

        function generate_option(metric) {
        var min_values = metric.min
        var max_values = metric.max
        var avg_values = metric.avg

        option = {
        title: {
        text: level,
        subtext: metric.method_name,
        left: 'center'
        },
        tooltip: {
        trigger: 'axis',
        axisPointer: {
        type: 'cross',
        animation: false,
        label: {
        backgroundColor: '#ccc',
        borderColor: '#aaa',
        borderWidth: 1,
        shadowBlur: 0,
        shadowOffsetX: 0,
        shadowOffsetY: 0,
        textStyle: {
        color: '#222'
        }
        }
        },
        formatter: function (params) {
        return params[2].name + '<br />' + params[2].value;
        }
        },
        grid: {
        left: '13%',
        right: '4%',
        bottom: '3%',
        containLabel: true
        },
        xAxis: {
        type: 'category',
        data: metric1.timestamp,
        /* axisLabel: {
        *   formatter: function (value, idx) {
        *     var date = new Date(value);
        *     return idx === 0 ? value : [date.getMonth() + 1, date.getDate()].join('-');
        *   }
        * },*/
        splitLine: {
        show: true,
        },
        boundaryGap: false,
        },
        yAxis: {
        'type': 'value',
        axisLabel: {
        formatter: function (val) {
        return val;
        }
        },
        axisPointer: {
        label: {
        formatter: function (params) {
        return params.value;
        }
        }
        },
        precision: 2,
        splitNumber: 3,
        splitLine: {
        show: true
        }
        },
        series: [{
        name: 'lower bound',
        type: 'line',
        data: min_values,
        lineStyle: {
        normal: {
        opacity: 0
        }
        },
        stack: 'metrics',
        symbol: 'none'
        }, {
        name: 'upper bound',
        type: 'line',
        data: max_values,
        lineStyle: {
        normal: {
        opacity: 0
        }
        },
        areaStyle: {
        normal: {
        color: '#cce'
        }
        },
        stack: 'metrics',
        symbol: 'none'
        }, {
        type: 'line',
        data: avg_values,
        hoverAnimation: false,
        symbolSize: 6,
        itemStyle: {
        normal: {
        color: '#c2352'
        }
        },
        showSymbol: false
        }]
        }
        return option;
        }
      </script>
      {% endfor %}

    </div>
    {% endfor %}
  </div>
</body>
